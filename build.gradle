apply plugin: 'base'
apply plugin: 'java'
apply plugin: 'war'

sourceSets {
  main { 
  	java {
    	srcDir 'src'
    }
    resources{
    	srcDir 'src'
    }
  }
}

repositories {
    mavenCentral()
}
 
dependencies {
    // struts 2
    compile group:'org.apache.struts',name:'struts2-core', version: '2.3.16.3+'
    // log
    compile 'commons-logging:commons-logging:1.1.3'
    compile 'commons-logging:commons-logging-api:1.1'
    // test
    testCompile group: 'junit', name: 'junit', version: '4.+'
}

void moveJarIntoLib(File file){
    println 'Added jar ' + file
        copy{
            from file
            into 'lib'
        }
}

task copyJarDependencies(type: Copy) {
    description = 'Used for Eclipse. Copies all dependency jar files to the lib directory.'
}
copyJarDependencies << {
	println 'Adding dependencies from compile configuration'
	configurations.compile.filter {it.name.endsWith 'jar'}.each { File file -> moveJarIntoLib(file)}
}
build.dependsOn(copyJarDependencies)

war {
	from 'WebContent'
	destinationDir = file("$buildDir/dist")
}

task wrapper(type: Wrapper) {
	gradleVersion = '2.0'
}